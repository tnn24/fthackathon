{
  "paragraphs": [
    {
      "title": "Select what you would like to view",
      "text": "%python",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 6.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "runOnSelectionChange": true,
        "title": true,
        "editorHide": true
      },
      "settings": {
        "params": {
          "formName": "",
          "day": "1",
          "Select Grade:": "7"
        },
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511049636017_-1219463970",
      "id": "20171119-000036_690636052",
      "dateCreated": "Nov 19, 2017 12:00:36 AM",
      "dateStarted": "Nov 19, 2017 5:52:07 AM",
      "dateFinished": "Nov 19, 2017 5:52:07 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\nimport sqlite3\n\ndb \u003d \"/notebook/data/data.db\"\ntable_name \u003d \"data\"\nconn \u003d sqlite3.connect(db)\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 6.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "editorHide": true,
        "tableHide": true,
        "lineNumbers": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1511061392068_-541092449",
      "id": "20171119-031632_441583707",
      "dateCreated": "Nov 19, 2017 3:16:32 AM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:22 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Select Grade:",
      "text": "%pyspark\n\noptions \u003d list()\nfor k in conn.execute(\"select GRADE from %s\" % table_name):\n    options.append(k[0])\noptions \u003d list(set(options))\ngrades \u003d [g for g in z.checkbox(\"Select Grade(s)\",\n        [(str(i), str(i)) for i in options],\n        options)]\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 8.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "runOnSelectionChange": true,
        "title": true,
        "editorHide": true
      },
      "settings": {
        "params": {
          "formName": "",
          "Select Grade:": 8.0,
          "": 12.0,
          "Select Grade(s)": [
            11.0,
            12.0,
            9.0,
            "12",
            "11"
          ],
          "fruit": []
        },
        "forms": {
          "Select Grade(s)": {
            "name": "Select Grade(s)",
            "displayName": "Select Grade(s)",
            "type": "checkbox",
            "defaultValue": [
              8.0,
              9.0,
              10.0,
              11.0,
              12.0
            ],
            "options": [
              {
                "value": "8",
                "displayName": "8"
              },
              {
                "value": "9",
                "displayName": "9"
              },
              {
                "value": "10",
                "displayName": "10"
              },
              {
                "value": "11",
                "displayName": "11"
              },
              {
                "value": "12",
                "displayName": "12"
              }
            ],
            "hidden": false
          }
        }
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1511051186477_1482252076",
      "id": "20171119-002626_1018963336",
      "dateCreated": "Nov 19, 2017 12:26:26 AM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:22 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Start Date",
      "text": "%pyspark\n# Create text input form\nstart_month \u003d z.select(\"Month:\", [(1, \u0027Jan\u0027),(2,\u0027Feb\u0027),(3,\u0027Mar\u0027),(4,\u0027Apr\u0027),(5,\u0027May\u0027),(6,\u0027June\u0027),(7,\u0027July\u0027),(8,\u0027Aug\u0027),(9,\u0027Sept\u0027),(10,\u0027Oct\u0027),(11,\u0027Nov\u0027),(12,\u0027Dec\u0027)])\n\n# Create text input form\nstart_day \u003d z.select(\"Day:\", [(1, \u00271\u0027),(2,\u00272\u0027),(3,\u00273\u0027),(4,\u00274\u0027),(5,\u00275\u0027),(6,\u00276\u0027),(7,\u00277\u0027),(8,\u00278\u0027),(9,\u00279\u0027),(10,\u002710\u0027),\n                           (11,\u002711\u0027),(13,\u002713\u0027),(14,\u002714\u0027),(15,\u002715\u0027),(16,\u002716\u0027),(17,\u002717\u0027),(18,\u002718\u0027),(19,\u002719\u0027),(20,\u002720\u0027),\n                           (21,\u002721\u0027),(22,\u002722\u0027),(23,\u002723\u0027),(24,\u002724\u0027),(25,\u002725\u0027),(26,\u002726\u0027),(27,\u002727\u0027),(28,\u002728\u0027),(29,\u002729\u0027),(30,\u002730\u0027),(31,\u002731\u0027)])\n             \nstart_year \u003d z.select(\"Year:\", [(2015, \u00272015\u0027),(2016,\u00272016\u0027),(2017,\u00272017\u0027),(2018,\u00272018\u0027)])              ",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 5.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "title": true,
        "runOnSelectionChange": true,
        "editorHide": true
      },
      "settings": {
        "params": {
          "formName": "",
          "Select Grade:": 1.0,
          "Month:": 9.0,
          "Day:": 1.0,
          "Year:": 2018.0
        },
        "forms": {
          "Month:": {
            "name": "Month:",
            "displayName": "Month:",
            "type": "select",
            "defaultValue": "",
            "options": [
              {
                "value": 1.0,
                "displayName": "Jan"
              },
              {
                "value": 2.0,
                "displayName": "Feb"
              },
              {
                "value": 3.0,
                "displayName": "Mar"
              },
              {
                "value": 4.0,
                "displayName": "Apr"
              },
              {
                "value": 5.0,
                "displayName": "May"
              },
              {
                "value": 6.0,
                "displayName": "June"
              },
              {
                "value": 7.0,
                "displayName": "July"
              },
              {
                "value": 8.0,
                "displayName": "Aug"
              },
              {
                "value": 9.0,
                "displayName": "Sept"
              },
              {
                "value": 10.0,
                "displayName": "Oct"
              },
              {
                "value": 11.0,
                "displayName": "Nov"
              },
              {
                "value": 12.0,
                "displayName": "Dec"
              }
            ],
            "hidden": false
          },
          "Day:": {
            "name": "Day:",
            "displayName": "Day:",
            "type": "select",
            "defaultValue": "",
            "options": [
              {
                "value": 1.0,
                "displayName": "1"
              },
              {
                "value": 2.0,
                "displayName": "2"
              },
              {
                "value": 3.0,
                "displayName": "3"
              },
              {
                "value": 4.0,
                "displayName": "4"
              },
              {
                "value": 5.0,
                "displayName": "5"
              },
              {
                "value": 6.0,
                "displayName": "6"
              },
              {
                "value": 7.0,
                "displayName": "7"
              },
              {
                "value": 8.0,
                "displayName": "8"
              },
              {
                "value": 9.0,
                "displayName": "9"
              },
              {
                "value": 10.0,
                "displayName": "10"
              },
              {
                "value": 11.0,
                "displayName": "11"
              },
              {
                "value": 13.0,
                "displayName": "13"
              },
              {
                "value": 14.0,
                "displayName": "14"
              },
              {
                "value": 15.0,
                "displayName": "15"
              },
              {
                "value": 16.0,
                "displayName": "16"
              },
              {
                "value": 17.0,
                "displayName": "17"
              },
              {
                "value": 18.0,
                "displayName": "18"
              },
              {
                "value": 19.0,
                "displayName": "19"
              },
              {
                "value": 20.0,
                "displayName": "20"
              },
              {
                "value": 21.0,
                "displayName": "21"
              },
              {
                "value": 22.0,
                "displayName": "22"
              },
              {
                "value": 23.0,
                "displayName": "23"
              },
              {
                "value": 24.0,
                "displayName": "24"
              },
              {
                "value": 25.0,
                "displayName": "25"
              },
              {
                "value": 26.0,
                "displayName": "26"
              },
              {
                "value": 27.0,
                "displayName": "27"
              },
              {
                "value": 28.0,
                "displayName": "28"
              },
              {
                "value": 29.0,
                "displayName": "29"
              },
              {
                "value": 30.0,
                "displayName": "30"
              },
              {
                "value": 31.0,
                "displayName": "31"
              }
            ],
            "hidden": false
          },
          "Year:": {
            "name": "Year:",
            "displayName": "Year:",
            "type": "select",
            "defaultValue": "",
            "options": [
              {
                "value": 2015.0,
                "displayName": "2015"
              },
              {
                "value": 2016.0,
                "displayName": "2016"
              },
              {
                "value": 2017.0,
                "displayName": "2017"
              },
              {
                "value": 2018.0,
                "displayName": "2018"
              }
            ],
            "hidden": false
          }
        }
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1511051658556_1927292183",
      "id": "20171119-003418_670817004",
      "dateCreated": "Nov 19, 2017 12:34:18 AM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:22 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "",
      "text": "",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 1.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/scala",
        "title": false,
        "runOnSelectionChange": true,
        "editorHide": true
      },
      "settings": {
        "params": {
          "formName": "",
          "Select Grade:": 1.0,
          "Month:": "",
          "Day:": "",
          "Year:": ""
        },
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1511053267644_-466728797",
      "id": "20171119-010107_1969485102",
      "dateCreated": "Nov 19, 2017 1:01:07 AM",
      "dateStarted": "Nov 19, 2017 1:02:30 AM",
      "dateFinished": "Nov 19, 2017 1:02:30 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "End Date",
      "text": "%pyspark\n# Create text input form\nend_month \u003d z.select(\"Month:\", [(1, \u0027Jan\u0027),(2,\u0027Feb\u0027),(3,\u0027Mar\u0027),(4,\u0027Apr\u0027),(5,\u0027May\u0027),(6,\u0027June\u0027),(7,\u0027July\u0027),(8,\u0027Aug\u0027),(9,\u0027Sept\u0027),(10,\u0027Oct\u0027),(11,\u0027Nov\u0027),(12,\u0027Dec\u0027)])\n\n# Create text input form\nend_day \u003d z.select(\"Day:\", [(1, \u00271\u0027),(2,\u00272\u0027),(3,\u00273\u0027),(4,\u00274\u0027),(5,\u00275\u0027),(6,\u00276\u0027),(7,\u00277\u0027),(8,\u00278\u0027),(9,\u00279\u0027),(10,\u002710\u0027),\n                           (11,\u002711\u0027),(13,\u002713\u0027),(14,\u002714\u0027),(15,\u002715\u0027),(16,\u002716\u0027),(17,\u002717\u0027),(18,\u002718\u0027),(19,\u002719\u0027),(20,\u002720\u0027),\n                           (21,\u002721\u0027),(22,\u002722\u0027),(23,\u002723\u0027),(24,\u002724\u0027),(25,\u002725\u0027),(26,\u002726\u0027),(27,\u002727\u0027),(28,\u002728\u0027),(29,\u002729\u0027),(30,\u002730\u0027),(31,\u002731\u0027)])\n             \nend_year \u003d z.select(\"Year:\", [(2015, \u00272015\u0027),(2016,\u00272016\u0027),(2017,\u00272017\u0027),(2018,\u00272018\u0027)])              ",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 5.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "title": true,
        "runOnSelectionChange": true,
        "editorHide": true
      },
      "settings": {
        "params": {
          "formName": "",
          "Select Grade:": 1.0,
          "Month:": 12.0,
          "Day:": 31.0,
          "Year:": 2018.0
        },
        "forms": {
          "Month:": {
            "name": "Month:",
            "displayName": "Month:",
            "type": "select",
            "defaultValue": "",
            "options": [
              {
                "value": 1.0,
                "displayName": "Jan"
              },
              {
                "value": 2.0,
                "displayName": "Feb"
              },
              {
                "value": 3.0,
                "displayName": "Mar"
              },
              {
                "value": 4.0,
                "displayName": "Apr"
              },
              {
                "value": 5.0,
                "displayName": "May"
              },
              {
                "value": 6.0,
                "displayName": "June"
              },
              {
                "value": 7.0,
                "displayName": "July"
              },
              {
                "value": 8.0,
                "displayName": "Aug"
              },
              {
                "value": 9.0,
                "displayName": "Sept"
              },
              {
                "value": 10.0,
                "displayName": "Oct"
              },
              {
                "value": 11.0,
                "displayName": "Nov"
              },
              {
                "value": 12.0,
                "displayName": "Dec"
              }
            ],
            "hidden": false
          },
          "Day:": {
            "name": "Day:",
            "displayName": "Day:",
            "type": "select",
            "defaultValue": "",
            "options": [
              {
                "value": 1.0,
                "displayName": "1"
              },
              {
                "value": 2.0,
                "displayName": "2"
              },
              {
                "value": 3.0,
                "displayName": "3"
              },
              {
                "value": 4.0,
                "displayName": "4"
              },
              {
                "value": 5.0,
                "displayName": "5"
              },
              {
                "value": 6.0,
                "displayName": "6"
              },
              {
                "value": 7.0,
                "displayName": "7"
              },
              {
                "value": 8.0,
                "displayName": "8"
              },
              {
                "value": 9.0,
                "displayName": "9"
              },
              {
                "value": 10.0,
                "displayName": "10"
              },
              {
                "value": 11.0,
                "displayName": "11"
              },
              {
                "value": 13.0,
                "displayName": "13"
              },
              {
                "value": 14.0,
                "displayName": "14"
              },
              {
                "value": 15.0,
                "displayName": "15"
              },
              {
                "value": 16.0,
                "displayName": "16"
              },
              {
                "value": 17.0,
                "displayName": "17"
              },
              {
                "value": 18.0,
                "displayName": "18"
              },
              {
                "value": 19.0,
                "displayName": "19"
              },
              {
                "value": 20.0,
                "displayName": "20"
              },
              {
                "value": 21.0,
                "displayName": "21"
              },
              {
                "value": 22.0,
                "displayName": "22"
              },
              {
                "value": 23.0,
                "displayName": "23"
              },
              {
                "value": 24.0,
                "displayName": "24"
              },
              {
                "value": 25.0,
                "displayName": "25"
              },
              {
                "value": 26.0,
                "displayName": "26"
              },
              {
                "value": 27.0,
                "displayName": "27"
              },
              {
                "value": 28.0,
                "displayName": "28"
              },
              {
                "value": 29.0,
                "displayName": "29"
              },
              {
                "value": 30.0,
                "displayName": "30"
              },
              {
                "value": 31.0,
                "displayName": "31"
              }
            ],
            "hidden": false
          },
          "Year:": {
            "name": "Year:",
            "displayName": "Year:",
            "type": "select",
            "defaultValue": "",
            "options": [
              {
                "value": 2015.0,
                "displayName": "2015"
              },
              {
                "value": 2016.0,
                "displayName": "2016"
              },
              {
                "value": 2017.0,
                "displayName": "2017"
              },
              {
                "value": 2018.0,
                "displayName": "2018"
              }
            ],
            "hidden": false
          }
        }
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1511053327863_-386624405",
      "id": "20171119-010207_1218012255",
      "dateCreated": "Nov 19, 2017 1:02:07 AM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:22 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\nfrom datetime import datetime\n\nd \u003d datetime(int(start_year), int(start_month), int(start_day))\nstart_date \u003d d.strftime(\u0027%s\u0027)\n\nd \u003d datetime(int(end_year), int(end_month), int(end_day))\nend_date \u003d d.strftime(\u0027%s\u0027)\n\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 1.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/python",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "paragraph_1511060724962_40077081",
      "id": "20171119-030524_466812499",
      "dateCreated": "Nov 19, 2017 3:05:24 AM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:22 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\nimport pandas as pd\nimport time\n\nsql_table \u003d \"length\"\n\nwhere_grade \u003d \"\"\nif grades:\n    where_grade \u003d (\"(\" +\n        \" OR \".join([\"GRADE \u003d \" + i for i in grades]) +\n        \")\")\n\nquery \u003d \"select CONVERSATION_START, CONVERSATION_END from \" + table_name\nif where_grade or start_date or end_date:\n    query +\u003d \" where \"\n    if where_grade:\n        query +\u003d where_grade\n    query +\u003d (\" and CONVERSATION_START \u003e\u003d %s and CONVERSATION_END \u003c\u003d %s\" % (start_date, end_date))\n    \nresults \u003d {\"start\": list(), \"length\": list()}\npattern \u003d \u0027%Y-%m-%d\u0027\nfor k in conn.execute(query + \" order by CONVERSATION_START\"):\n    results[\"start\"].append(time.strftime(pattern, time.localtime(float(k[0]))))\n    results[\"length\"].append((k[1] - k[0])/3600)\n    \nif not results:\n    print \"No records found\"\n\ntry:\n    data \u003d pd.DataFrame(data\u003dresults)\n    df \u003d sqlContext.createDataFrame(data)\n    df.registerTempTable(sql_table)\n    print \"Length of conversations with students%s between %s and %s\" % ((\" in grades \" + \", \".join(sorted(grades))) if grades else \" in all grades\",\n            time.strftime(pattern, time.localtime(float(start_date))), time.strftime(pattern, time.localtime(float(end_date))))\nexcept:\n    pass\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Length of conversations with students in grades 11, 12 between 2018-09-01 and 2018-12-31\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511120956111_-1011904375",
      "id": "20171119-194916_369968058",
      "dateCreated": "Nov 19, 2017 7:49:16 PM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:22 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Total",
      "text": "%sql\nSELECT start, length\nFROM length\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "stackedAreaChart",
              "height": 309.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql"
        },
        "editorMode": "ace/mode/sql",
        "editorHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "start\tlength\n2018-09-01\t7\n2018-09-01\t8\n2018-09-01\t10\n2018-09-01\t11\n2018-09-01\t5\n2018-09-01\t7\n2018-09-01\t7\n2018-09-01\t4\n2018-09-01\t4\n2018-09-01\t1\n2018-09-01\t3\n2018-09-01\t2\n2018-09-01\t1\n2018-09-01\t6\n2018-09-02\t9\n2018-09-02\t11\n2018-09-02\t7\n2018-09-02\t8\n2018-09-02\t9\n2018-09-02\t9\n2018-09-02\t3\n2018-09-02\t3\n2018-09-02\t4\n2018-09-02\t3\n2018-09-02\t7\n2018-09-02\t1\n2018-09-02\t6\n2018-09-03\t10\n2018-09-03\t5\n2018-09-03\t4\n2018-09-03\t6\n2018-09-03\t8\n2018-09-03\t4\n2018-09-03\t5\n2018-09-03\t1\n2018-09-03\t3\n2018-09-03\t1\n2018-09-03\t5\n2018-09-03\t7\n2018-09-04\t8\n2018-09-04\t9\n2018-09-04\t7\n2018-09-04\t7\n2018-09-04\t4\n2018-09-04\t6\n2018-09-05\t10\n2018-09-05\t7\n2018-09-05\t3\n2018-09-05\t4\n2018-09-05\t6\n2018-09-05\t1\n2018-09-05\t5\n2018-09-05\t2\n2018-09-05\t6\n2018-09-06\t9\n2018-09-06\t4\n2018-09-06\t7\n2018-09-06\t10\n2018-09-06\t5\n2018-09-06\t2\n2018-09-06\t6\n2018-09-06\t2\n2018-09-06\t1\n2018-09-06\t4\n2018-09-07\t11\n2018-09-07\t7\n2018-09-07\t7\n2018-09-07\t6\n2018-09-07\t3\n2018-09-07\t7\n2018-09-07\t4\n2018-09-07\t5\n2018-09-07\t2\n2018-09-07\t2\n2018-09-07\t4\n2018-09-07\t5\n2018-09-08\t10\n2018-09-08\t7\n2018-09-08\t5\n2018-09-08\t7\n2018-09-08\t5\n2018-09-08\t9\n2018-09-08\t3\n2018-09-08\t1\n2018-09-08\t6\n2018-09-08\t6\n2018-09-09\t9\n2018-09-09\t8\n2018-09-09\t9\n2018-09-09\t3\n2018-09-09\t4\n2018-09-09\t6\n2018-09-09\t7\n2018-09-09\t2\n2018-09-09\t5\n2018-09-09\t1\n2018-09-09\t1\n2018-09-09\t5\n2018-09-09\t2\n2018-09-09\t5\n2018-09-10\t5\n2018-09-10\t6\n2018-09-10\t4\n2018-09-10\t7\n2018-09-10\t3\n2018-09-11\t7\n2018-09-11\t8\n2018-09-11\t5\n2018-09-11\t2\n2018-09-11\t5\n2018-09-11\t2\n2018-09-11\t8\n2018-09-12\t11\n2018-09-12\t4\n2018-09-12\t5\n2018-09-12\t6\n2018-09-12\t10\n2018-09-12\t8\n2018-09-12\t9\n2018-09-12\t7\n2018-09-12\t2\n2018-09-12\t2\n2018-09-12\t5\n2018-09-12\t1\n2018-09-13\t10\n2018-09-13\t8\n2018-09-13\t7\n2018-09-13\t4\n2018-09-13\t3\n2018-09-13\t2\n2018-09-13\t5\n2018-09-13\t5\n2018-09-13\t2\n2018-09-13\t2\n2018-09-13\t1\n2018-09-14\t6\n2018-09-14\t7\n2018-09-14\t7\n2018-09-14\t3\n2018-09-14\t1\n2018-09-14\t3\n2018-09-14\t4\n2018-09-15\t7\n2018-09-15\t3\n2018-09-15\t5\n2018-09-15\t3\n2018-09-15\t3\n2018-09-15\t0\n2018-09-16\t10\n2018-09-16\t4\n2018-09-16\t5\n2018-09-16\t8\n2018-09-16\t3\n2018-09-16\t7\n2018-09-16\t3\n2018-09-17\t9\n2018-09-17\t4\n2018-09-17\t5\n2018-09-17\t5\n2018-09-17\t6\n2018-09-17\t3\n2018-09-17\t4\n2018-09-17\t1\n2018-09-17\t2\n2018-09-18\t9\n2018-09-18\t6\n2018-09-18\t8\n2018-09-18\t9\n2018-09-19\t5\n2018-09-19\t6\n2018-09-19\t8\n2018-09-19\t9\n2018-09-19\t7\n2018-09-19\t4\n2018-09-19\t3\n2018-09-19\t3\n2018-09-19\t5\n2018-09-19\t6\n2018-09-19\t3\n2018-09-19\t4\n2018-09-19\t6\n2018-09-19\t1\n2018-09-19\t4\n2018-09-19\t4\n2018-09-20\t5\n2018-09-20\t5\n2018-09-20\t9\n2018-09-20\t5\n2018-09-20\t6\n2018-09-20\t10\n2018-09-20\t7\n2018-09-20\t3\n2018-09-20\t7\n2018-09-20\t7\n2018-09-20\t9\n2018-09-20\t4\n2018-09-20\t8\n2018-09-20\t5\n2018-09-20\t3\n2018-09-20\t6\n2018-09-21\t11\n2018-09-21\t11\n2018-09-21\t6\n2018-09-21\t4\n2018-09-21\t4\n2018-09-21\t8\n2018-09-21\t8\n2018-09-21\t5\n2018-09-21\t4\n2018-09-21\t3\n2018-09-21\t4\n2018-09-21\t2\n2018-09-21\t0\n2018-09-21\t0\n2018-09-22\t11\n2018-09-22\t9\n2018-09-22\t4\n2018-09-22\t5\n2018-09-22\t8\n2018-09-22\t8\n2018-09-22\t7\n2018-09-22\t2\n2018-09-22\t1\n2018-09-22\t5\n2018-09-22\t2\n2018-09-23\t6\n2018-09-23\t6\n2018-09-23\t5\n2018-09-23\t5\n2018-09-23\t6\n2018-09-23\t2\n2018-09-23\t1\n2018-09-23\t3\n2018-09-23\t1\n2018-09-23\t6\n2018-09-24\t3\n2018-09-24\t7\n2018-09-24\t4\n2018-09-24\t4\n2018-09-24\t3\n2018-09-25\t7\n2018-09-25\t10\n2018-09-25\t4\n2018-09-25\t4\n2018-09-25\t2\n2018-09-25\t2\n2018-09-25\t5\n2018-09-26\t8\n2018-09-26\t8\n2018-09-26\t9\n2018-09-26\t2\n2018-09-26\t6\n2018-09-26\t2\n2018-09-26\t4\n2018-09-27\t9\n2018-09-27\t9\n2018-09-27\t10\n2018-09-27\t7\n2018-09-27\t7\n2018-09-27\t8\n2018-09-27\t7\n2018-09-27\t4\n2018-09-27\t2\n2018-09-27\t1\n2018-09-27\t3\n2018-09-27\t1\n2018-09-28\t9\n2018-09-28\t8\n2018-09-28\t10\n2018-09-28\t9\n2018-09-28\t4\n2018-09-28\t4\n2018-09-29\t6\n2018-09-29\t7\n2018-09-29\t9\n2018-09-29\t9\n2018-09-29\t6\n2018-09-29\t3\n2018-09-30\t9\n2018-09-30\t5\n2018-09-30\t4\n2018-09-30\t9\n2018-09-30\t5\n2018-09-30\t7\n2018-09-30\t5\n2018-09-30\t1\n2018-09-30\t3\n2018-10-01\t5\n2018-10-01\t9\n2018-10-01\t3\n2018-10-01\t7\n2018-10-01\t8\n2018-10-01\t5\n2018-10-01\t4\n2018-10-01\t1\n2018-10-02\t5\n2018-10-02\t7\n2018-10-02\t5\n2018-10-02\t8\n2018-10-02\t7\n2018-10-02\t5\n2018-10-02\t7\n2018-10-02\t5\n2018-10-03\t7\n2018-10-03\t5\n2018-10-03\t5\n2018-10-03\t7\n2018-10-03\t8\n2018-10-03\t7\n2018-10-03\t8\n2018-10-03\t4\n2018-10-03\t3\n2018-10-03\t2\n2018-10-04\t10\n2018-10-04\t5\n2018-10-04\t5\n2018-10-04\t3\n2018-10-04\t9\n2018-10-04\t7\n2018-10-04\t5\n2018-10-04\t5\n2018-10-04\t4\n2018-10-04\t2\n2018-10-04\t7\n2018-10-05\t7\n2018-10-05\t9\n2018-10-05\t10\n2018-10-05\t3\n2018-10-05\t8\n2018-10-05\t1\n2018-10-05\t1\n2018-10-05\t0\n2018-10-06\t6\n2018-10-06\t5\n2018-10-06\t5\n2018-10-06\t8\n2018-10-06\t6\n2018-10-06\t2\n2018-10-06\t1\n2018-10-06\t5\n2018-10-06\t4\n2018-10-06\t1\n2018-10-07\t10\n2018-10-07\t9\n2018-10-07\t8\n2018-10-07\t6\n2018-10-07\t3\n2018-10-07\t6\n2018-10-07\t2\n2018-10-07\t1\n2018-10-07\t3\n2018-10-07\t8\n2018-10-07\t5\n2018-10-07\t6\n2018-10-07\t3\n2018-10-08\t7\n2018-10-08\t4\n2018-10-08\t8\n2018-10-08\t9\n2018-10-08\t5\n2018-10-08\t3\n2018-10-08\t5\n2018-10-08\t4\n2018-10-08\t7\n2018-10-08\t6\n2018-10-08\t3\n2018-10-08\t6\n2018-10-08\t2\n2018-10-08\t6\n2018-10-09\t8\n2018-10-09\t7\n2018-10-09\t7\n2018-10-09\t4\n2018-10-09\t1\n2018-10-09\t4\n2018-10-09\t5\n2018-10-09\t3\n2018-10-09\t5\n2018-10-09\t3\n2018-10-09\t4\n2018-10-10\t11\n2018-10-10\t7\n2018-10-10\t4\n2018-10-10\t3\n2018-10-10\t9\n2018-10-10\t4\n2018-10-10\t3\n2018-10-10\t7\n2018-10-10\t0\n2018-10-11\t11\n2018-10-11\t6\n2018-10-11\t5\n2018-10-11\t6\n2018-10-11\t3\n2018-10-11\t4\n2018-10-11\t6\n2018-10-11\t6\n2018-10-11\t2\n2018-10-11\t0\n2018-10-11\t5\n2018-10-12\t10\n2018-10-12\t9\n2018-10-12\t7\n2018-10-12\t8\n2018-10-12\t7\n2018-10-12\t1\n2018-10-12\t3\n2018-10-12\t1\n2018-10-13\t10\n2018-10-13\t9\n2018-10-13\t9\n2018-10-13\t5\n2018-10-13\t5\n2018-10-13\t2\n2018-10-13\t6\n2018-10-13\t6\n2018-10-14\t9\n2018-10-14\t7\n2018-10-14\t3\n2018-10-14\t8\n2018-10-14\t4\n2018-10-14\t7\n2018-10-14\t2\n2018-10-15\t9\n2018-10-15\t4\n2018-10-15\t6\n2018-10-15\t8\n2018-10-15\t3\n2018-10-15\t5\n2018-10-15\t7\n2018-10-15\t6\n2018-10-16\t5\n2018-10-16\t6\n2018-10-16\t5\n2018-10-17\t7\n2018-10-17\t7\n2018-10-17\t4\n2018-10-17\t8\n2018-10-17\t4\n2018-10-17\t8\n2018-10-17\t7\n2018-10-17\t3\n2018-10-18\t10\n2018-10-18\t4\n2018-10-18\t8\n2018-10-18\t10\n2018-10-18\t4\n2018-10-18\t5\n2018-10-18\t7\n2018-10-18\t2\n2018-10-18\t5\n2018-10-18\t7\n2018-10-18\t7\n2018-10-18\t2\n2018-10-18\t2\n2018-10-19\t5\n2018-10-19\t8\n2018-10-19\t6\n2018-10-19\t6\n2018-10-19\t7\n2018-10-19\t5\n2018-10-19\t4\n2018-10-19\t4\n2018-10-20\t9\n2018-10-20\t11\n2018-10-20\t9\n2018-10-20\t5\n2018-10-20\t4\n2018-10-20\t5\n2018-10-20\t6\n2018-10-20\t5\n2018-10-20\t2\n2018-10-21\t9\n2018-10-21\t5\n2018-10-21\t4\n2018-10-21\t6\n2018-10-21\t5\n2018-10-21\t6\n2018-10-21\t0\n2018-10-22\t10\n2018-10-22\t7\n2018-10-22\t3\n2018-10-22\t3\n2018-10-22\t4\n2018-10-22\t6\n2018-10-22\t3\n2018-10-22\t6\n2018-10-23\t9\n2018-10-23\t5\n2018-10-23\t8\n2018-10-23\t5\n2018-10-23\t2\n2018-10-23\t2\n2018-10-23\t8\n2018-10-23\t4\n2018-10-23\t2\n2018-10-23\t4\n2018-10-23\t2\n2018-10-23\t2\n2018-10-23\t3\n2018-10-23\t1\n2018-10-24\t4\n2018-10-25\t5\n2018-10-25\t3\n2018-10-25\t5\n2018-10-25\t8\n2018-10-25\t1\n2018-10-26\t11\n2018-10-26\t4\n2018-10-26\t4\n2018-10-26\t5\n2018-10-27\t11\n2018-10-27\t10\n2018-10-27\t8\n2018-10-27\t6\n2018-10-27\t6\n2018-10-27\t3\n2018-10-27\t6\n2018-10-27\t7\n2018-10-27\t2\n2018-10-27\t5\n2018-10-27\t6\n2018-10-27\t1\n2018-10-28\t10\n2018-10-28\t8\n2018-10-28\t4\n2018-10-28\t3\n2018-10-28\t5\n2018-10-28\t4\n2018-10-28\t5\n2018-10-28\t3\n2018-10-28\t2\n2018-10-28\t6\n2018-10-29\t6\n2018-10-29\t7\n2018-10-29\t10\n2018-10-29\t9\n2018-10-29\t8\n2018-10-29\t8\n2018-10-29\t6\n2018-10-29\t4\n2018-10-29\t5\n2018-10-30\t8\n2018-10-30\t9\n2018-10-30\t6\n2018-10-30\t2\n2018-10-30\t4\n2018-10-30\t4\n2018-10-30\t1\n2018-10-30\t3\n2018-10-31\t5\n2018-10-31\t6\n2018-10-31\t7\n2018-10-31\t9\n2018-10-31\t6\n2018-10-31\t4\n2018-11-01\t5\n2018-11-01\t4\n2018-11-01\t6\n2018-11-01\t3\n2018-11-01\t6\n2018-11-01\t4\n2018-11-01\t4\n2018-11-01\t6\n2018-11-02\t8\n2018-11-02\t5\n2018-11-02\t7\n2018-11-02\t3\n2018-11-02\t3\n2018-11-02\t3\n2018-11-02\t4\n2018-11-02\t3\n2018-11-02\t3\n2018-11-03\t9\n2018-11-03\t9\n2018-11-03\t5\n2018-11-03\t7\n2018-11-03\t7\n2018-11-03\t4\n2018-11-03\t3\n2018-11-03\t6\n2018-11-03\t6\n2018-11-03\t4\n2018-11-03\t3\n2018-11-03\t3\n2018-11-03\t2\n2018-11-04\t5\n2018-11-04\t5\n2018-11-04\t6\n2018-11-04\t5\n2018-11-04\t3\n2018-11-04\t3\n2018-11-04\t6\n2018-11-05\t6\n2018-11-05\t9\n2018-11-05\t5\n2018-11-05\t6\n2018-11-05\t8\n2018-11-05\t5\n2018-11-05\t4\n2018-11-05\t4\n2018-11-06\t5\n2018-11-06\t5\n2018-11-06\t6\n2018-11-06\t3\n2018-11-06\t4\n2018-11-06\t2\n2018-11-06\t6\n2018-11-06\t4\n2018-11-06\t0\n2018-11-06\t3\n2018-11-07\t5\n2018-11-07\t8\n2018-11-07\t3\n2018-11-07\t4\n2018-11-07\t8\n2018-11-07\t3\n2018-11-07\t4\n2018-11-07\t7\n2018-11-07\t4\n2018-11-07\t1\n2018-11-07\t5\n2018-11-07\t1\n2018-11-07\t3\n2018-11-07\t6\n2018-11-07\t6\n2018-11-07\t6\n2018-11-07\t5\n2018-11-08\t4\n2018-11-08\t4\n2018-11-08\t8\n2018-11-08\t6\n2018-11-08\t9\n2018-11-08\t7\n2018-11-08\t5\n2018-11-09\t9\n2018-11-09\t7\n2018-11-09\t7\n2018-11-09\t9\n2018-11-09\t7\n2018-11-09\t3\n2018-11-09\t1\n2018-11-10\t6\n2018-11-10\t9\n2018-11-10\t4\n2018-11-10\t8\n2018-11-10\t2\n2018-11-10\t4\n2018-11-10\t5\n2018-11-11\t9\n2018-11-11\t6\n2018-11-11\t10\n2018-11-11\t3\n2018-11-11\t3\n2018-11-11\t4\n2018-11-11\t4\n2018-11-12\t6\n2018-11-12\t7\n2018-11-12\t10\n2018-11-12\t7\n2018-11-12\t4\n2018-11-12\t6\n2018-11-12\t5\n2018-11-12\t3\n2018-11-12\t3\n2018-11-13\t5\n2018-11-13\t7\n2018-11-13\t9\n2018-11-13\t4\n2018-11-13\t7\n2018-11-13\t3\n2018-11-13\t4\n2018-11-14\t5\n2018-11-14\t4\n2018-11-14\t9\n2018-11-14\t4\n2018-11-14\t8\n2018-11-14\t8\n2018-11-14\t3\n2018-11-14\t6\n2018-11-14\t2\n2018-11-15\t6\n2018-11-15\t8\n2018-11-15\t4\n2018-11-15\t8\n2018-11-16\t5\n2018-11-16\t6\n2018-11-16\t6\n2018-11-16\t7\n2018-11-16\t2\n2018-11-16\t2\n2018-11-16\t2\n2018-11-16\t6\n2018-11-16\t6\n2018-11-16\t2\n2018-11-16\t5\n2018-11-17\t10\n2018-11-17\t4\n2018-11-17\t5\n2018-11-17\t4\n2018-11-17\t5\n2018-11-17\t3\n2018-11-17\t3\n2018-11-17\t1\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511121383997_166193469",
      "id": "20171119-195623_466215113",
      "dateCreated": "Nov 19, 2017 7:56:23 PM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:22 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\nimport pandas as pd\nimport time\n\nsql_table \u003d \"topics\"\n\nwhere_grade \u003d \"\"\nif grades:\n    where_grade \u003d (\"(\" +\n        \" OR \".join([\"GRADE \u003d \" + i for i in grades]) +\n        \")\")\n\nquery \u003d \"select CONVERSATION_TOPIC, GENDER from \" + table_name\nif where_grade or start_date or end_date:\n    query +\u003d \" where \"\n    if where_grade:\n        query +\u003d where_grade\n    query +\u003d (\" and CONVERSATION_START \u003e\u003d %s and CONVERSATION_END \u003c\u003d %s\" % (start_date, end_date))\n    \nresults \u003d dict()\nfor k in conn.execute(query):\n    if k[0] not in results:\n        results[k[0]] \u003d dict()\n    if k[1].lower() not in results[k[0]]:\n        results[k[0]][k[1].lower()] \u003d 1\n    else:\n        results[k[0]][k[1].lower()] +\u003d 1\n        \nif not results:\n    print \"No records found\"\n        \ntry:\n    dic \u003d {\"topic\": list(), \"male_count\": list(), \"female_count\": list(), \"total_count\": list()}\n    for topic in results:\n        dic[\"topic\"].append(topic)\n        dic[\"male_count\"].append(results[topic][\"male\"])\n        dic[\"female_count\"].append(results[topic][\"female\"])\n        dic[\"total_count\"].append(results[topic][\"male\"] + results[topic][\"female\"])\n    \n    data \u003d pd.DataFrame(data\u003ddic)\n    df \u003d sqlContext.createDataFrame(data)\n    df.registerTempTable(sql_table)\n    pattern \u003d \u0027%Y-%m-%d\u0027\n    print \"Topics that students%s discussed between %s and %s\" % ((\" in grades \" + \", \".join(sorted(grades))) if grades else \" in all grades\",\n            time.strftime(pattern, time.localtime(float(start_date))), time.strftime(pattern, time.localtime(float(end_date))))\nexcept:\n    pass\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Topics that students in grades 11, 12 discussed between 2018-09-01 and 2018-12-31\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511068569683_-507805426",
      "id": "20171119-051609_1823306021",
      "dateCreated": "Nov 19, 2017 5:16:09 AM",
      "dateStarted": "Nov 19, 2017 8:29:22 PM",
      "dateFinished": "Nov 19, 2017 8:29:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Total",
      "text": "%sql\nSELECT topic, total_count\nFROM topics\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:22 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 309.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql"
        },
        "editorMode": "ace/mode/sql",
        "editorHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "topic\ttotal_count\nFaith\t33\nAnxiety\t187\nBible\t46\nLove\t16\nCareer\t16\nSex\t22\nSuicide\t79\nMarriage\t29\nGospel\t100\nDiscipleship\t19\nWorship\t14\nDepression\t143\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511063498706_891915482",
      "id": "20171119-035138_1621305539",
      "dateCreated": "Nov 19, 2017 3:51:38 AM",
      "dateStarted": "Nov 19, 2017 8:29:23 PM",
      "dateFinished": "Nov 19, 2017 8:29:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Male",
      "text": "%sql\nSELECT topic, male_count\nFROM topics\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:23 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "stackedAreaChart": {
                  "style": "stack"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "topic",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "male_count",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql"
        },
        "editorMode": "ace/mode/sql",
        "lineNumbers": false,
        "title": true,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "topic\tmale_count\nFaith\t19\nAnxiety\t107\nBible\t29\nLove\t9\nCareer\t5\nSex\t11\nSuicide\t29\nMarriage\t13\nGospel\t55\nDiscipleship\t7\nWorship\t4\nDepression\t81\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511119486928_-1396784614",
      "id": "20171119-192446_35883243",
      "dateCreated": "Nov 19, 2017 7:24:46 PM",
      "dateStarted": "Nov 19, 2017 8:29:23 PM",
      "dateFinished": "Nov 19, 2017 8:29:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Female",
      "text": "%sql\nSELECT topic, female_count\nFROM topics\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:23 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 300.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql"
        },
        "editorMode": "ace/mode/sql",
        "title": true,
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "topic\tfemale_count\nFaith\t14\nAnxiety\t80\nBible\t17\nLove\t7\nCareer\t11\nSex\t11\nSuicide\t50\nMarriage\t16\nGospel\t45\nDiscipleship\t12\nWorship\t10\nDepression\t62\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511119485560_-1165935274",
      "id": "20171119-192445_2126801299",
      "dateCreated": "Nov 19, 2017 7:24:45 PM",
      "dateStarted": "Nov 19, 2017 8:29:23 PM",
      "dateFinished": "Nov 19, 2017 8:29:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\nimport pandas as pd\nimport time\n\nsql_table \u003d \"outcome\"\n\nwhere_grade \u003d \"\"\nif grades:\n    where_grade \u003d (\"(\" +\n        \" OR \".join([\"GRADE \u003d \" + i for i in grades]) +\n        \")\")\n\nquery \u003d \"select CONVERSATION_OUTCOME, GENDER from \" + table_name\nif where_grade or start_date or end_date:\n    query +\u003d \" where \"\n    if where_grade:\n        query +\u003d where_grade\n    query +\u003d (\" and CONVERSATION_START \u003e\u003d %s and CONVERSATION_END \u003c\u003d %s\" % (start_date, end_date))\n    \nresults \u003d dict()\nfor k in conn.execute(query):\n    if k[0] not in results:\n        results[k[0]] \u003d dict()\n    if k[1].lower() not in results[k[0]]:\n        results[k[0]][k[1].lower()] \u003d 1\n    else:\n        results[k[0]][k[1].lower()] +\u003d 1\n        \nif not results:\n    print \"No records found\"\ntry:\n    dic \u003d {\"outcome\": list(), \"male_count\": list(), \"female_count\": list(), \"total_count\": list()}\n    for outcome in results:\n        dic[\"outcome\"].append(outcome)\n        dic[\"male_count\"].append(results[outcome][\"male\"])\n        dic[\"female_count\"].append(results[outcome][\"female\"])\n        dic[\"total_count\"].append(results[outcome][\"male\"] + results[outcome][\"female\"])\n    \n    data \u003d pd.DataFrame(data\u003ddic)\n    df \u003d sqlContext.createDataFrame(data)\n    df.registerTempTable(sql_table)\n    pattern \u003d \u0027%Y-%m-%d\u0027\n    print \"Outcome of conversations with students%s between %s and %s\" % ((\" in grades \" + \", \".join(sorted(grades))) if grades else \" in all grades\",\n            time.strftime(pattern, time.localtime(float(start_date))), time.strftime(pattern, time.localtime(float(end_date))))\nexcept:\n    pass\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:23 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Outcome of conversations with students in grades 11, 12 between 2018-09-01 and 2018-12-31\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511119761522_-965295039",
      "id": "20171119-192921_1289415956",
      "dateCreated": "Nov 19, 2017 7:29:21 PM",
      "dateStarted": "Nov 19, 2017 8:29:23 PM",
      "dateFinished": "Nov 19, 2017 8:29:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Total",
      "text": "%sql\nSELECT outcome, total_count\nFROM outcome\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:23 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 309.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql"
        },
        "editorMode": "ace/mode/sql",
        "editorHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "outcome\ttotal_count\nNo Response\t20\nSpiritual Conversation\t286\nOther\t56\nProfession of Faith\t103\nGospel Presentation\t239\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511119828809_-2010749746",
      "id": "20171119-193028_337728510",
      "dateCreated": "Nov 19, 2017 7:30:28 PM",
      "dateStarted": "Nov 19, 2017 8:29:23 PM",
      "dateFinished": "Nov 19, 2017 8:29:23 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Male",
      "text": "%sql\nSELECT outcome, male_count\nFROM outcome",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:23 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 300.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql"
        },
        "editorMode": "ace/mode/sql",
        "editorHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "outcome\tmale_count\nNo Response\t13\nSpiritual Conversation\t150\nOther\t25\nProfession of Faith\t54\nGospel Presentation\t127\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511120570730_-1275622124",
      "id": "20171119-194250_849638662",
      "dateCreated": "Nov 19, 2017 7:42:50 PM",
      "dateStarted": "Nov 19, 2017 8:29:23 PM",
      "dateFinished": "Nov 19, 2017 8:29:24 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Female",
      "text": "%sql\nSELECT outcome, female_count\nFROM outcome",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:24 PM",
      "config": {
        "colWidth": 4.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 300.0,
              "optionOpen": false
            },
            "helium": {}
          }
        },
        "editorSetting": {
          "language": "sql"
        },
        "editorMode": "ace/mode/sql",
        "editorHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "outcome\tfemale_count\nNo Response\t7\nSpiritual Conversation\t136\nOther\t31\nProfession of Faith\t49\nGospel Presentation\t112\n"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511120572714_-463032447",
      "id": "20171119-194252_669906814",
      "dateCreated": "Nov 19, 2017 7:42:52 PM",
      "dateStarted": "Nov 19, 2017 8:29:24 PM",
      "dateFinished": "Nov 19, 2017 8:29:24 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:24 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python"
        },
        "editorMode": "ace/mode/python",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1511063537765_-1560428035",
      "id": "20171119-035217_1484474288",
      "dateCreated": "Nov 19, 2017 3:52:17 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%angular\n\n\u003cform class\u003d\"form-inline\"\u003e\n  \u003cbutton type\u003d\"submit\" class\u003d\"btn btn-primary\" ng-click\u003d\"z.runParagraph(\u002720171119-002626_1018963336\u0027); \n                                                            z.runParagraph(\u002720171119-003418_670817004\u0027);\n                                                            z.runParagraph(\u002720171119-010207_1218012255\u0027);\n                                                            z.runParagraph(\u002720171119-030524_466812499\u0027);\n                                                            z.runParagraph(\u002720171119-031632_441583707\u0027);\n                                                            z.runParagraph(\u002720171119-051609_1823306021\u0027);\n                                                            z.runParagraph(\u002720171119-035138_1621305539\u0027);\n                                                            \"\u003e\n    Check Out\u003c/button\u003e\n\u003c/form\u003e\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:24 PM",
      "config": {
        "colWidth": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/undefined",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "ANGULAR",
            "data": "\u003cform class\u003d\"form-inline\"\u003e\n  \u003cbutton type\u003d\"submit\" class\u003d\"btn btn-primary\" ng-click\u003d\"z.runParagraph(\u002720171119-002626_1018963336\u0027); \n                                                            z.runParagraph(\u002720171119-003418_670817004\u0027);\n                                                            z.runParagraph(\u002720171119-010207_1218012255\u0027);\n                                                            z.runParagraph(\u002720171119-030524_466812499\u0027);\n                                                            z.runParagraph(\u002720171119-031632_441583707\u0027);\n                                                            z.runParagraph(\u002720171119-051609_1823306021\u0027);\n                                                            z.runParagraph(\u002720171119-035138_1621305539\u0027);\n                                                            \"\u003e\n    Check Out\u003c/button\u003e\n\u003c/form\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1511123076237_1067663954",
      "id": "20171119-202436_1548171093",
      "dateCreated": "Nov 19, 2017 8:24:36 PM",
      "dateStarted": "Nov 19, 2017 8:29:24 PM",
      "dateFinished": "Nov 19, 2017 8:29:24 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%angular\n",
      "user": "anonymous",
      "dateUpdated": "Nov 19, 2017 8:29:24 PM",
      "config": {
        "colWidth": 12.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": true
        },
        "editorMode": "ace/mode/undefined"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1511123327352_-515640711",
      "id": "20171119-202847_856049507",
      "dateCreated": "Nov 19, 2017 8:28:47 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Analytics for Christ by 4-EVER YOUNG",
  "id": "2CZUJ4PM1",
  "angularObjects": {
    "2CXUDNETA:shared_process": [],
    "2CZDMPW6D:shared_process": [],
    "2D1UJBDY3:shared_process": [],
    "2CXV8MD6Q:shared_process": [],
    "2CY7783CR:shared_process": [],
    "2D1GJNXDV:shared_process": [],
    "2CZG75UJV:shared_process": [],
    "2D1S12EE3:shared_process": [],
    "2D1VUNY9B:shared_process": [],
    "2CZXA9E8M:shared_process": [],
    "2D1MB2NBE:shared_process": [],
    "2D12NYX3Y:shared_process": [],
    "2CYGWYKC4:shared_process": [],
    "2CZP6XJRX:shared_process": [],
    "2CY1DJZWG:shared_process": [],
    "2CZ8PUAK4:shared_process": [],
    "2D29JPMCT:shared_process": [],
    "2CZM9UTCU:shared_process": [],
    "2CXXUV9AJ:shared_process": []
  },
  "config": {
    "looknfeel": "simple",
    "personalizedMode": "false"
  },
  "info": {}
}